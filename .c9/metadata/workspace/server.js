{"filter":false,"title":"server.js","tooltip":"/server.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":168,"column":57},"end":{"row":168,"column":58},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":58},"end":{"row":168,"column":59},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":59},"end":{"row":168,"column":60},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":60},"end":{"row":168,"column":61},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":61},"end":{"row":168,"column":62},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":61},"end":{"row":168,"column":62},"action":"remove","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":61},"end":{"row":168,"column":62},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":61},"end":{"row":168,"column":62},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":63},"end":{"row":168,"column":64},"action":"insert","lines":["!"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":20},"end":{"row":157,"column":21},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":21},"end":{"row":157,"column":22},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":22},"end":{"row":157,"column":24},"action":"insert","lines":["{}"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":23},"end":{"row":157,"column":24},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":24},"end":{"row":157,"column":25},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":25},"end":{"row":157,"column":26},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":26},"end":{"row":157,"column":27},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":26},"end":{"row":157,"column":27},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":26},"end":{"row":157,"column":27},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":23},"end":{"row":157,"column":27},"action":"remove","lines":["last"]},{"start":{"row":157,"column":23},"end":{"row":157,"column":32},"action":"insert","lines":["lastError"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":32},"end":{"row":157,"column":33},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":33},"end":{"row":157,"column":34},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":34},"end":{"row":157,"column":35},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":156,"column":46},"end":{"row":157,"column":25},"action":"insert","lines":["","  var sess = req.session;"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":35},"end":{"row":158,"column":55},"action":"insert","lines":["sess.login.lastError"]}]}],[{"group":"doc","deltas":[{"start":{"row":169,"column":9},"end":{"row":169,"column":14},"action":"remove","lines":["login"]}]}],[{"group":"doc","deltas":[{"start":{"row":169,"column":8},"end":{"row":169,"column":9},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":40},"end":{"row":158,"column":45},"action":"remove","lines":["login"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":39},"end":{"row":158,"column":40},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":157,"column":25},"end":{"row":158,"column":0},"action":"insert","lines":["",""]},{"start":{"row":158,"column":0},"end":{"row":158,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":2},"end":{"row":158,"column":3},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":3},"end":{"row":158,"column":4},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":4},"end":{"row":158,"column":5},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":5},"end":{"row":158,"column":6},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":6},"end":{"row":158,"column":7},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":7},"end":{"row":158,"column":8},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":8},"end":{"row":158,"column":9},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":9},"end":{"row":158,"column":10},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":10},"end":{"row":158,"column":11},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":11},"end":{"row":158,"column":12},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":12},"end":{"row":158,"column":13},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":10},"end":{"row":158,"column":11},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":9},"end":{"row":158,"column":10},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":8},"end":{"row":158,"column":9},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":7},"end":{"row":158,"column":8},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":6},"end":{"row":158,"column":7},"action":"remove","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":6},"end":{"row":158,"column":7},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":6},"end":{"row":158,"column":7},"action":"remove","lines":["l"]},{"start":{"row":158,"column":6},"end":{"row":158,"column":15},"action":"insert","lines":["lastError"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":17},"end":{"row":158,"column":18},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":18},"end":{"row":158,"column":32},"action":"insert","lines":["sess.lastError"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":32},"end":{"row":158,"column":33},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":158,"column":33},"end":{"row":159,"column":0},"action":"insert","lines":["",""]},{"start":{"row":159,"column":0},"end":{"row":159,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":2},"end":{"row":159,"column":16},"action":"insert","lines":["sess.lastError"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":16},"end":{"row":159,"column":17},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":17},"end":{"row":159,"column":18},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":18},"end":{"row":159,"column":19},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":19},"end":{"row":159,"column":20},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":20},"end":{"row":159,"column":21},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":20},"end":{"row":159,"column":21},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":19},"end":{"row":159,"column":20},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":18},"end":{"row":159,"column":19},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":17},"end":{"row":159,"column":18},"action":"remove","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":16},"end":{"row":159,"column":17},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":2},"end":{"row":159,"column":3},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":3},"end":{"row":159,"column":4},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":4},"end":{"row":159,"column":5},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":5},"end":{"row":159,"column":6},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":6},"end":{"row":159,"column":7},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":7},"end":{"row":159,"column":8},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":8},"end":{"row":159,"column":9},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":159,"column":23},"end":{"row":159,"column":24},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":160,"column":35},"end":{"row":160,"column":49},"action":"remove","lines":["sess.lastError"]},{"start":{"row":160,"column":35},"end":{"row":160,"column":44},"action":"insert","lines":["lastError"]}]}],[{"group":"doc","deltas":[{"start":{"row":171,"column":59},"end":{"row":172,"column":0},"action":"insert","lines":["",""]},{"start":{"row":172,"column":0},"end":{"row":172,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":171,"column":59},"end":{"row":172,"column":4},"action":"remove","lines":["","    "]},{"start":{"row":171,"column":59},"end":{"row":172,"column":29},"action":"insert","lines":["","  res.redirect(302, '/user');"]}]}],[{"group":"doc","deltas":[{"start":{"row":172,"column":22},"end":{"row":172,"column":26},"action":"remove","lines":["user"]},{"start":{"row":172,"column":22},"end":{"row":172,"column":27},"action":"insert","lines":["login"]}]}],[{"group":"doc","deltas":[{"start":{"row":171,"column":45},"end":{"row":171,"column":46},"action":"remove","lines":["x"]}]}],[{"group":"doc","deltas":[{"start":{"row":171,"column":45},"end":{"row":171,"column":46},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":3},"end":{"row":173,"column":4},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":4},"end":{"row":173,"column":5},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":5},"end":{"row":173,"column":6},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":6},"end":{"row":173,"column":7},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":7},"end":{"row":173,"column":8},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":8},"end":{"row":173,"column":9},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":9},"end":{"row":173,"column":10},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":9},"end":{"row":173,"column":10},"action":"remove","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":8},"end":{"row":173,"column":9},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":7},"end":{"row":173,"column":8},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":6},"end":{"row":173,"column":7},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":5},"end":{"row":173,"column":6},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":4},"end":{"row":173,"column":5},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":4},"end":{"row":174,"column":29},"action":"remove","lines":["","  res.redirect(302, '/user');"]}]}],[{"group":"doc","deltas":[{"start":{"row":169,"column":33},"end":{"row":170,"column":29},"action":"insert","lines":["","  res.redirect(302, '/user');"]}]}],[{"group":"doc","deltas":[{"start":{"row":170,"column":2},"end":{"row":170,"column":4},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":173,"column":0},"end":{"row":173,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":186,"column":0},"end":{"row":244,"column":0},"action":"remove","lines":["","","","","","io.on('connection', function (socket) {","    messages.forEach(function (data) {","      socket.emit('message', data);","    });","","    sockets.push(socket);","","    socket.on('disconnect', function () {","      sockets.splice(sockets.indexOf(socket), 1);","      updateRoster();","    });","","    socket.on('message', function (msg) {","      var text = String(msg || '');","","      if (!text)","        return;","","      socket.get('name', function (err, name) {","        var data = {","          name: name,","          text: text","        };","","        broadcast('message', data);","        messages.push(data);","      });","    });","","    socket.on('identify', function (name) {","      socket.set('name', String(name || 'Anonymous'), function (err) {","        updateRoster();","      });","    });","  });","","function updateRoster() {","  async.map(","    sockets,","    function (socket, callback) {","      socket.get('name', callback);","    },","    function (err, names) {","      broadcast('roster', names);","    }","  );","}","","function broadcast(event, data) {","  sockets.forEach(function (socket) {","    socket.emit(event, data);","  });","}",""]}]}],[{"group":"doc","deltas":[{"start":{"row":50,"column":0},"end":{"row":154,"column":2},"action":"remove","lines":["var value = 'default';","router.get('/test', function(req, res, next){","  console.log(req.body);","  if(req.body.fname) {","    value = req.body.fname","  }","  res.render('test', {value : value})","});","","router.post('/test', function(req, res, next){","  console.log(req.body);","  if(req.body.fname) {","    value = req.body.fname","  }","  res.render('test', {value : value})","});","","router.get('/delay.html', function(req, res, next){","  console.log(req.body);","  if(req.body.fname) {","    value = req.body.fname","  }","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.write('<html><head></head><body>\\r\\n');","  setTimeout(function() {","    res.write('1<br>   <style>*{ color:red ;}</style>\\r\\n')","  }, 1000);","  setTimeout(function() {","    res.write('2<br>   <style>*{ color:blue ;}</style>\\r\\n')","  }, 2000);","  setTimeout(function() {","    res.write('3<br>   <style>*{ color:purple ;}</style>\\r\\n')","  }, 3000);","  setTimeout(function() {","    res.write('4<br>   <style>*{ color:yellow ;}</style>\\r\\n')","  }, 4000);","  setTimeout(function() {","    res.write('5<br>   <style>*{ color:black ;}</style>\\r\\n')","  }, 5000);","  setTimeout(function() {","    res.end('eof</body></html>')","  }, 6000);","});","","","router.get('/delay.css', function(req, res, next){","  res.setHeader('Content-Type', \"text/css\");","  setTimeout(function() {","    res.end('*{background : red};')","  }, 10000);","})","","router.get('/delay-empty.css', function(req, res, next){","  res.setHeader('Content-Type', \"text/css\");","  setTimeout(function() {","    res.end('/* no content here*/')","  }, 10000);","})","","router.get('/normal.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.end('<html><head>   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay.css\">    </head><body>  content here   </body></html>')","})","router.get('/normal1.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.end('<html><head></head><body>  content here   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay.css\">    </body></html>')","})","","router.get('/emptycss.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.end('<html><head>   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay-empty.css\">    </head><body>  content here   </body></html>')","})","router.get('/emptycss1.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.end('<html><head></head><body>  content here   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay-empty.css\">    </body></html>')","})","","router.get('/normal-chunk.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.write('<html><head>   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay.css\">    </head><body>  ');","  setTimeout(function() {","    res.end('content here   </body></html>')","  }, 1000);","})","router.get('/normal0-chunk.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.write('<!doctype html>');","  setTimeout(function() {","    res.end('<html><head></head><body>  content here   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay.css\">    </body></html>')","  }, 1000);","})","router.get('/normal1-chunk.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.write('<!doctype html><html><head></head><body>  ');","  setTimeout(function() {","    res.end('content here   <link rel=\"stylesheet\" type=\"text/css\" href=\"delay.css\">    </body></html>')","  }, 1000);","})","router.get('/normal2-chunk.html', function(req, res, next){","  res.setHeader('Content-Type', \"text/html; charset=UTF-8\");","  res.write('<!doctype html><html><head></head><body>  content here   ');","  setTimeout(function() {","    res.end('<link rel=\"stylesheet\" type=\"text/css\" href=\"delay.css\">    </body></html>')","  }, 1000);","})"]}]}],[{"group":"doc","deltas":[{"start":{"row":49,"column":0},"end":{"row":50,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":9,"column":1},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":1},"end":{"row":9,"column":2},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":15},"end":{"row":84,"column":20},"action":"remove","lines":["Chat "]}]}]]},"ace":{"folds":[],"scrolltop":1182.5,"scrollleft":0,"selection":{"start":{"row":81,"column":0},"end":{"row":81,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":72,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1428583777760,"hash":"bad3c1da5219812521893cc7347fec310d88eb58"}